# Create the data frame directly
df <- read.table(text = "
g13065 SUPER_GRC2 5.063979 SRR9969366
g14637 SUPER_GRC2 14.798087 SRR9969366
g16029 SUPER_GRC2 7.036938 SRR9969366
g17249 SUPER_GRC2 6.072952 SRR9969366
g18526 SUPER_GRC2 2.67809 SRR9969366
g19121 SUPER_GRC2 41.305958 SRR9969366
g6396 SUPER_GRC1 13.838957 SRR9969366
g14257 SUPER_GRC2 4.486667 SRR9969367
g14637 SUPER_GRC2 14.469788 SRR9969367
g16029 SUPER_GRC2 7.273699 SRR9969367
g17249 SUPER_GRC2 6.94768 SRR9969367
g19121 SUPER_GRC2 33.009911 SRR9969367
g14637 SUPER_GRC2 17.710766 SRR9969368
g16029 SUPER_GRC2 6.18028 SRR9969368
g17249 SUPER_GRC2 6.224977 SRR9969368
g19121 SUPER_GRC2 47.313873 SRR9969368
g6396 SUPER_GRC1 8.627867 SRR9969368
g14637 SUPER_GRC2 17.945404 SRR9969369
g16029 SUPER_GRC2 4.859523 SRR9969369
g19121 SUPER_GRC2 60.931011 SRR9969369
g6396 SUPER_GRC1 12.727557 SRR9969369
g14637 SUPER_GRC2 14.237 SRR9969372
g16029 SUPER_GRC2 5.478258 SRR9969372
g19121 SUPER_GRC2 60.642773 SRR9969372
g14257 SUPER_GRC2 1.515775 SRR9969373
g14637 SUPER_GRC2 14.244519 SRR9969373
g16029 SUPER_GRC2 4.391506 SRR9969373
g17249 SUPER_GRC2 1.676604 SRR9969373
g19121 SUPER_GRC2 56.520016 SRR9969373
", header = FALSE, sep = " ", col.names = c("Gene", "Group", "TPM", "Library"))

# Compute average TPM per gene *within each group*
avg_tpm <- aggregate(TPM ~ Gene + Group, data = df, FUN = mean)

# View the result
print(avg_tpm)
